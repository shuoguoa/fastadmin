<include file="Public/head"/>
<body class="no-skin">
    <div class="bootstrap-table1">
        <div class="fixed-table-toolbar">
            <div class="commonsearch-table" >
                <form class="form-inline form-commonsearch nice-validator n-default" action="{:U('UserAmount/Horde')}" method="post" novalidate="novalidate">
                    <fieldset>
                        <div class="form-group" style="margin: 5px">
                            <label for="id" class="control-label" style="padding:0 10px">部落名称:</label>
                            <input type="text" class="form-control" name="name" value="{:I('name')}" >
                        </div>
                        <div class="form-group" style="margin: 5px">
                            <label for="id" class="control-label" style="padding:0 10px">ID:</label>
                            <input type="text" class="form-control" name="vid" value="{:I('vid')}" >
                        </div>
                        <div class="form-group" style="margin:5px">
                            <div class="col-sm-12 text-center">
                                <button type="submit" class="btn btn-success" style="background: #18bc9c;border-radius:3px;height:30px;">搜 索</button> 
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
        <div class="fixed-table-container" style="padding-bottom: 0px;">
            <div class="fixed-table-body">
                <table id="table" class="table table-striped table-bordered table-hover" style="width: 100%;margin-top: 0"> 
                    <thead> 
                        <tr>
                            <th data-field="id" class="table-th">
                                <div class="th-inner ">id</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th data-field="id" class="table-th">
                                <div class="th-inner ">部落名称</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th data-field="id" class="table-th">
                                <div class="th-inner ">ID&nbsp;&nbsp;(部落显示id)</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th data-field="id" class="table-th">
                                <div class="th-inner ">部落创建者</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th class="table-th-1" data-field="pid">
                                <div class="th-inner ">俱乐部ID</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th class="table-th-1" data-field="name">
                                <div class="th-inner ">限制开关</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th class="table-th" data-field="status">
                                <div class="th-inner ">能否修改过</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th class="table-th" data-field="operate">
                                <div class="th-inner ">部落创建时间</div>
                                <div class="fht-cell"></div>
                            </th>
                            <th class="table-th-2" data-field="operate">
                                <div class="th-inner ">操作</div>
                                <div class="fht-cell"></div>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="data-listidx">
                        <volist name="list" id="val">
                            <tr data-index="{$val['id']}"> 
                                <td class="tbody-td">{$val['id']}</td> 
                                <td class="tbody-td">{$val['name']}</td> 
                                <td class="tbody-td-1">{$val['horde_vid']}</td>
                                <td class="tbody-td-1">{$val['owner']}</td>
                                <td class="tbody-td">{$val['tid']}</td> 
                                <td class="tbody-td">{$val['is_control']}</td> 
                                <td class="tbody-td">{$val['is_modify']}</td>
                                <td class="tbody-td">{$val['ctime']}</td>
                                <td class="tbody-td-1">
                                    <button class="btn btn-info recharge" id="dialog-recharge" onclick="updateVid('{$val['id']}', '{$val['name']}','{$val['horde_vid']}')">修改ID</button>
                                </td> 
                            </tr>
                        </volist>
                    </tbody>
                </table>
            </div>
        </div>
        <div >{$page}</div>
    </div>
</div>
</body>
</html>


<div id="dialog" class="ui-dialog-content1 ui-widget-content" style="width: auto; min-height: 50px; max-height: none; height: auto;">
    <div class="form-group">
        <label for="action" class="control-label col-xs-12 col-sm-2">部落名称:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" name="uname" value="" aria-required="true" readonly="true" id="uname">
            <input type="hidden" name="uid" value="" id="id" readonly="true">
        </div>
    </div><br/>
    <div class="form-group">
        <label for="action" class="control-label col-xs-12 col-sm-2">ID:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" name="uvid" value="" aria-required="true">
        </div>
    </div><br/>
    
  <br/>
    <div class="form-group" >
        <label for="action" class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="submit" class="btn btn-info btn-embossed" id="submit-vid">修改</button>
        </div>
    </div><br/>
</div>

<div id="dialog2" class="ui-dialog-content1 ui-widget-content" style="width: auto; min-height: 50px; max-height: none; height: auto;">
    <div class="form-group">
        <label for="action" class="control-label col-xs-12 col-sm-2">修改ID为:</label>
        <div class="col-xs-12 col-sm-8">
            <input type="text" class="form-control" name="uvvid" value="" aria-required="true" readonly="true" id="updateId" style="color: #19e07d;font-size:16px;overflow: auto">
        </div>
    </div><br/>
   <br/>
    <div class="form-group" >
        <label for="action" class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <input type="submit" class="btn btn-info btn-embossed" id="submit" role="button" value="是">
            <input type="reset" class="btn btn-info btn-embossed" id="reset" role="button" value="取消操作">
        </div>
    </div><br/>
</div>


<include file="Public/footerjs"/>

<script type="text/javascript">

$( "#dialog" ).dialog({
    autoOpen: false,
    width: 450,
    height:250,
    title:'修改vid'
});

$( "#dialog2" ).dialog({
    autoOpen: false,
    width: 400,
    height:230,
    title:'确认'
});

   function updateVid(id, name,vid){ 
        $("input[name='uid']").val(id);
        $("input[name='uname']").val(name);
        $("input[name='uvid']").val(vid);
        $( "#dialog" ).dialog( "open" );
        event.preventDefault();
    }
    var rule = /^[0-9]*[1-9][0-9]*$/;
    $("#submit-vid").click(function(){
        var id = $("input[name='uid']").val();
        var vid = $("input[name='uvid']").val();
        if (vid == '') {
            alert('请输入ID值');
            return false;
        } else if (!rule.test(vid)){
            alert('输入正整数！');
            return false;
        } else{
            // alert(vid);
            $("#updateId").val(vid);
            $( "#dialog2" ).dialog( "open" );
            event.preventDefault();
            $("#submit").click(function(){
                $.post("{:U('UserAmount/updateHordeVid')}", {id:id, vid:vid}, function(data){   
                   if (data.status == 'ok') { 
                        alert(data.msg);
                        window.location.reload();
                    }else {
                        alert(data.msg);
                        return false;
                    } 
                });
            });

            $("#reset").click(function(){
                $(".ui-button").click();
                window.location.reload();
            });
        }
    });

    $(function(){
        $('.btn-countly').click(function(){
            var href = $(this).attr('href');
            href = href+'&flag=1';
            $(this).attr('href', href);
        });
    });
</script>
</body>
</html>
